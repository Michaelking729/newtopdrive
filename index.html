<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Top Drive | Ijebu-Ode Ride-Hailing Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #0a2e5c;
            --secondary: #1a5fb4;
            --accent: #ffcc00;
            --driver-color: #28a745;
            --success: #28a745;
            --danger: #dc3545;
            --light: #f8f9fa;
            --dark: #212529;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: #f5f7fa;
            color: #333;
            line-height: 1.6;
            overflow: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Login Screen */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.5s ease;
        }
        
        .login-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .login-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            width: 90%;
            max-width: 450px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            text-align: center;
        }
        
        .login-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            font-family: 'Montserrat', sans-serif;
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 30px;
        }
        
        .login-logo i {
            color: var(--accent);
            font-size: 3rem;
        }
        
        .login-logo span {
            color: var(--accent);
        }
        
        .login-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .login-subtitle {
            color: #666;
            margin-bottom: 30px;
        }
        
        .login-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .login-option-btn {
            background: var(--light);
            border: 2px solid #e1e5eb;
            border-radius: 10px;
            padding: 15px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .login-option-btn:hover {
            border-color: var(--secondary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .login-option-btn i {
            font-size: 1.5rem;
            width: 30px;
        }
        
        .user-login i { color: var(--primary); }
        .driver-login i { color: var(--driver-color); }
        .admin-login i { color: var(--secondary); }
        
        .login-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e5eb;
            border-radius: 10px;
            font-size: 1rem;
            margin-bottom: 20px;
            transition: border 0.3s;
        }
        
        .login-input:focus {
            outline: none;
            border-color: var(--secondary);
        }
        
        .login-btn {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border: none;
            width: 100%;
            padding: 16px;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }
        
        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(26, 95, 180, 0.3);
        }
        
        /* Header */
        header {
            background: white;
            padding: 15px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            position: relative;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.6rem;
            font-weight: 800;
            color: var(--primary);
            cursor: pointer;
        }
        
        .logo i {
            color: var(--accent);
            font-size: 2rem;
        }
        
        .logo span {
            color: var(--accent);
        }
        
        .app-mode {
            display: flex;
            gap: 10px;
        }
        
        .mode-btn {
            background: var(--light);
            border: none;
            color: var(--dark);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .mode-btn.active {
            background: var(--secondary);
            color: white;
            box-shadow: 0 4px 10px rgba(26, 95, 180, 0.2);
        }
        
        .mode-btn.driver-active {
            background: var(--driver-color);
            color: white;
        }
        
        .mode-btn:hover {
            transform: translateY(-2px);
        }
        
        .user-menu {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .user-menu-btn {
            background: var(--light);
            border: none;
            color: var(--dark);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .user-menu-btn:hover {
            background: var(--secondary);
            color: white;
        }
        
        .driver-menu-btn {
            background: var(--driver-color);
            color: white;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--accent);
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            cursor: pointer;
        }
        
        .driver-avatar {
            background: var(--driver-color);
        }
        
        /* Main Layout */
        .main-content {
            display: flex;
            height: calc(100vh - 80px);
        }
        
        /* Map Container */
        .map-container {
            flex: 1;
            position: relative;
            background: #e0e7f0;
        }
        
        #map {
            height: 100%;
            width: 100%;
            z-index: 1;
        }
        
        .map-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .map-control-btn {
            background: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--primary);
            font-size: 1.2rem;
            transition: all 0.3s;
        }
        
        .map-control-btn:hover {
            background: var(--secondary);
            color: white;
            transform: scale(1.1);
        }
        
        /* Ride Panel */
        .ride-panel {
            width: 420px;
            background: white;
            padding: 25px;
            box-shadow: -4px 0 15px rgba(0, 0, 0, 0.05);
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        
        .panel-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .panel-title i {
            color: var(--accent);
        }
        
        .driver-panel-title {
            color: var(--driver-color);
        }
        
        .driver-panel-title i {
            color: var(--driver-color);
        }
        
        /* Location Inputs */
        .location-inputs {
            margin-bottom: 25px;
        }
        
        .input-group {
            display: flex;
            align-items: center;
            background: var(--light);
            padding: 12px 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border: 1px solid #e1e5eb;
        }
        
        .input-group.active {
            border-color: var(--secondary);
            background: #edf4ff;
        }
        
        .input-group i {
            color: #6c757d;
            margin-right: 12px;
            font-size: 1.1rem;
        }
        
        .input-group input {
            background: transparent;
            border: none;
            width: 100%;
            font-size: 0.95rem;
            color: #333;
        }
        
        .input-group input:focus {
            outline: none;
        }
        
        .swap-locations {
            display: flex;
            justify-content: center;
            margin: 5px 0;
        }
        
        .swap-btn {
            background: #e9ecef;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            color: #6c757d;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .swap-btn:hover {
            background: #dee2e6;
            transform: rotate(180deg);
        }
        
        /* Ijebu Locations Quick Pick */
        .ijebu-locations {
            margin-bottom: 20px;
        }
        
        .locations-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }
        
        .location-tag {
            background: #f0f8ff;
            border: 1px solid #c2e0ff;
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .location-tag:hover {
            background: #e1f0ff;
            transform: translateY(-2px);
        }
        
        /* Car Selection */
        .car-selection {
            margin-bottom: 25px;
        }
        
        .cars-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 10px;
        }
        
        .car-option {
            background: var(--light);
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .car-option:hover {
            border-color: var(--secondary);
        }
        
        .car-option.selected {
            border-color: var(--secondary);
            background: #edf4ff;
            box-shadow: 0 4px 12px rgba(26, 95, 180, 0.1);
        }
        
        .car-icon {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .car-name {
            font-weight: 600;
            font-size: 0.95rem;
            margin-bottom: 5px;
        }
        
        .car-price {
            font-size: 0.9rem;
            color: var(--success);
            font-weight: 500;
        }
        
        .car-capacity {
            font-size: 0.8rem;
            color: #6c757d;
            margin-top: 5px;
        }
        
        /* Find Driver Button */
        .find-driver-btn {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border: none;
            width: 100%;
            padding: 16px;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .find-driver-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(26, 95, 180, 0.3);
        }
        
        .find-driver-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        /* Driver Offers Panel */
        .driver-offers-panel {
            display: none;
            flex: 1;
            flex-direction: column;
        }
        
        .offers-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
        }
        
        .offers-subtitle {
            color: #666;
            text-align: center;
            margin-bottom: 25px;
            font-size: 0.95rem;
        }
        
        .offers-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            flex: 1;
            overflow-y: auto;
            padding-right: 5px;
        }
        
        .driver-offer {
            background: var(--light);
            border-radius: 12px;
            padding: 20px;
            border: 2px solid #e9ecef;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .driver-offer:hover {
            border-color: var(--secondary);
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.08);
        }
        
        .driver-offer.selected {
            border-color: var(--secondary);
            background: #edf4ff;
            box-shadow: 0 8px 16px rgba(26, 95, 180, 0.15);
        }
        
        .offer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .driver-name {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--primary);
        }
        
        .offer-price {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary);
        }
        
        .offer-details {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .driver-rating {
            color: var(--accent);
            font-weight: 600;
        }
        
        .driver-car {
            font-size: 0.9rem;
            color: #666;
        }
        
        .driver-eta {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            color: #666;
        }
        
        .offer-actions {
            display: flex;
            gap: 10px;
        }
        
        .accept-btn {
            flex: 1;
            background: var(--success);
            color: white;
            border: none;
            padding: 10px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .accept-btn:hover {
            background: #218838;
            transform: translateY(-2px);
        }
        
        .counter-btn {
            flex: 1;
            background: var(--accent);
            color: var(--primary);
            border: none;
            padding: 10px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .counter-btn:hover {
            background: #e6b800;
            transform: translateY(-2px);
        }
        
        /* Ride Status Panel */
        .ride-status-panel {
            display: none;
            flex: 1;
            flex-direction: column;
        }
        
        .status-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .status-title {
            font-weight: 700;
            color: var(--primary);
            font-size: 1.2rem;
        }
        
        .status-badge {
            background: var(--accent);
            color: var(--primary);
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
        }
        
        .driver-info {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
            padding-bottom: 25px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .driver-avatar-large {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: var(--light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: var(--primary);
            border: 3px solid var(--secondary);
        }
        
        .driver-details h4 {
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--primary);
            font-size: 1.3rem;
        }
        
        .driver-details .rating {
            color: var(--accent);
            margin-bottom: 5px;
        }
        
        .driver-details .car {
            font-size: 0.95rem;
            color: #666;
        }
        
        .ride-details {
            background: var(--light);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .ride-detail {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .ride-detail:last-child {
            margin-bottom: 0;
            padding-top: 10px;
            border-top: 1px solid #dee2e6;
            font-weight: 700;
            color: var(--primary);
        }
        
        .ride-progress {
            margin-bottom: 25px;
        }
        
        .progress-bar-container {
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            margin-bottom: 15px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: var(--secondary);
            width: 0%;
            transition: width 0.5s;
            border-radius: 3px;
        }
        
        .progress-steps {
            display: flex;
            justify-content: space-between;
        }
        
        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 0.8rem;
            color: #666;
        }
        
        .step-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #e9ecef;
            margin-bottom: 5px;
        }
        
        .progress-step.active .step-indicator {
            background: var(--secondary);
            box-shadow: 0 0 0 3px rgba(26, 95, 180, 0.2);
        }
        
        .progress-step.completed .step-indicator {
            background: var(--secondary);
        }
        
        .cancel-ride-btn {
            background: white;
            color: var(--danger);
            border: 2px solid var(--danger);
            width: 100%;
            padding: 14px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: auto;
        }
        
        .cancel-ride-btn:hover {
            background: var(--danger);
            color: white;
        }
        
        /* ==================== DRIVER DASHBOARD ==================== */
        .driver-dashboard {
            display: none;
            width: 100%;
            padding: 30px;
            overflow-y: auto;
            height: calc(100vh - 80px);
        }
        
        .driver-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .driver-title {
            font-size: 2rem;
            font-weight: 800;
            color: var(--driver-color);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .driver-title i {
            color: var(--driver-color);
        }
        
        .driver-status-toggle {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .status-toggle {
            position: relative;
            width: 70px;
            height: 34px;
        }
        
        .status-toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .status-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .status-slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .status-slider {
            background-color: var(--driver-color);
        }
        
        input:checked + .status-slider:before {
            transform: translateX(36px);
        }
        
        .online-status {
            background: var(--driver-color);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .driver-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .driver-stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            gap: 15px;
            border-left: 5px solid var(--driver-color);
        }
        
        .driver-stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            background: var(--driver-color);
        }
        
        .driver-stat-info h3 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--driver-color);
        }
        
        .driver-stat-info p {
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        .driver-tabs {
            display: flex;
            border-bottom: 2px solid #e9ecef;
            margin-bottom: 25px;
        }
        
        .driver-tab {
            padding: 15px 25px;
            font-weight: 600;
            color: #6c757d;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .driver-tab.active {
            color: var(--driver-color);
            border-bottom: 3px solid var(--driver-color);
        }
        
        .driver-tab:hover {
            color: var(--driver-color);
        }
        
        .driver-tab-content {
            display: none;
        }
        
        .driver-tab-content.active {
            display: block;
        }
        
        /* Live Ride Requests */
        .ride-requests {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .ride-request-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            border-left: 5px solid var(--accent);
            transition: all 0.3s;
        }
        
        .ride-request-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }
        
        .request-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .request-price {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--driver-color);
        }
        
        .request-timer {
            background: var(--danger);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
        }
        
        .request-details {
            margin-bottom: 20px;
        }
        
        .request-location {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }
        
        .request-location i {
            color: var(--secondary);
        }
        
        .request-actions {
            display: flex;
            gap: 10px;
        }
        
        .accept-request-btn {
            flex: 1;
            background: var(--driver-color);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .accept-request-btn:hover {
            background: #218838;
            transform: translateY(-2px);
        }
        
        .decline-request-btn {
            flex: 1;
            background: var(--danger);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .decline-request-btn:hover {
            background: #c82333;
            transform: translateY(-2px);
        }
        
        /* Active Ride Panel */
        .active-ride-panel {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }
        
        .active-ride-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .active-ride-title {
            font-weight: 700;
            color: var(--driver-color);
            font-size: 1.3rem;
        }
        
        .active-ride-status {
            background: var(--accent);
            color: var(--primary);
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
        }
        
        .active-ride-details {
            margin-bottom: 25px;
        }
        
        .rider-info {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .rider-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--primary);
        }
        
        .rider-details h4 {
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--primary);
            font-size: 1.2rem;
        }
        
        .rider-details .rating {
            color: var(--accent);
            margin-bottom: 5px;
        }
        
        .ride-actions {
            display: flex;
            gap: 10px;
        }
        
        .ride-action-btn {
            flex: 1;
            padding: 12px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
        }
        
        .arrived-btn {
            background: var(--driver-color);
            color: white;
        }
        
        .start-trip-btn {
            background: var(--secondary);
            color: white;
        }
        
        .complete-trip-btn {
            background: var(--success);
            color: white;
        }
        
        .ride-action-btn:hover {
            transform: translateY(-2px);
        }
        
        /* Driver Earnings */
        .earnings-chart {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }
        
        .chart-placeholder {
            height: 200px;
            background: #f8f9fa;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c757d;
            font-weight: 600;
            margin-top: 20px;
        }
        
        /* Driver Rating */
        .driver-rating-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            text-align: center;
        }
        
        .rating-stars {
            font-size: 2.5rem;
            color: var(--accent);
            margin-bottom: 15px;
        }
        
        .rating-number {
            font-size: 3rem;
            font-weight: 800;
            color: var(--driver-color);
            margin-bottom: 10px;
        }
        
        .rating-count {
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        /* Admin Dashboard */
        .admin-dashboard {
            display: none;
            width: 100%;
            padding: 30px;
            overflow-y: auto;
            height: calc(100vh - 80px);
        }
        
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .admin-title {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .admin-title i {
            color: var(--accent);
        }
        
        .admin-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }
        
        .stat-info h3 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        .stat-info p {
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        .admin-tabs {
            display: flex;
            border-bottom: 2px solid #e9ecef;
            margin-bottom: 25px;
        }
        
        .admin-tab {
            padding: 15px 25px;
            font-weight: 600;
            color: #6c757d;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .admin-tab.active {
            color: var(--primary);
            border-bottom: 3px solid var(--secondary);
        }
        
        .admin-tab:hover {
            color: var(--primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .data-table {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }
        
        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .table-title {
            font-weight: 700;
            color: var(--primary);
            font-size: 1.2rem;
        }
        
        .table-controls {
            display: flex;
            gap: 10px;
        }
        
        .table-controls button {
            background: var(--light);
            border: 1px solid #e9ecef;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .table-controls button:hover {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        thead {
            background: #f8f9fa;
        }
        
        th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #495057;
            border-bottom: 1px solid #e9ecef;
        }
        
        td {
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .status-indicator {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .status-completed {
            background: #d4edda;
            color: #155724;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-cancelled {
            background: #f8d7da;
            color: #721c24;
        }
        
        .status-active {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        
        .action-btn {
            padding: 6px 12px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s;
        }
        
        .edit-btn {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .edit-btn:hover {
            background: #bee5eb;
        }
        
        .delete-btn {
            background: #f8d7da;
            color: #721c24;
        }
        
        .delete-btn:hover {
            background: #f1b0b7;
        }
        
        /* Responsive Design */
        @media (max-width: 1100px) {
            .ride-panel {
                width: 380px;
            }
            
            .driver-stats, .admin-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 1024px) {
            .main-content {
                flex-direction: column;
            }
            
            .ride-panel {
                width: 100%;
                max-width: 600px;
                margin: 0 auto;
                height: 50vh;
            }
            
            .map-container {
                height: 50vh;
            }
            
            .locations-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-wrap: wrap;
                gap: 15px;
            }
            
            .app-mode {
                order: 3;
                width: 100%;
                justify-content: center;
            }
            
            .driver-stats, .admin-stats {
                grid-template-columns: 1fr;
            }
            
            .cars-grid, .request-actions, .ride-actions {
                grid-template-columns: 1fr;
            }
            
            .locations-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* Animations */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .slide-in {
            animation: slideIn 0.5s ease forwards;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .blink {
            animation: blink 1s infinite;
        }
        
        /* Utility Classes */
        .hidden {
            display: none !important;
        }
        
        .visible {
            display: flex !important;
        }
        
        .block {
            display: block !important;
        }
        
        .text-success {
            color: var(--success);
        }
        
        .text-danger {
            color: var(--danger);
        }
        
        .text-driver {
            color: var(--driver-color);
        }
        
        .mb-3 {
            margin-bottom: 15px;
        }
        
        .mb-4 {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-screen" id="login-screen">
        <div class="login-content">
            <div class="login-logo">
                <i class="fas fa-car"></i>
                <div>TOP<span>DRIVE</span></div>
            </div>
            
            <h2 class="login-title">Welcome to Top Drive</h2>
            <p class="login-subtitle">Ijebu-Ode's premier ride-hailing service</p>
            
            <div class="login-options">
                <button class="login-option-btn user-login" data-role="user">
                    <i class="fas fa-user"></i>
                    <div>
                        <div style="font-weight: 700; color: var(--primary);">Rider Login</div>
                        <div style="font-size: 0.9rem; color: #666;">Book rides in Ijebu-Ode</div>
                    </div>
                </button>
                
                <button class="login-option-btn driver-login" data-role="driver">
                    <i class="fas fa-car"></i>
                    <div>
                        <div style="font-weight: 700; color: var(--driver-color);">Driver Login</div>
                        <div style="font-size: 0.9rem; color: #666;">Earn money driving</div>
                    </div>
                </button>
                
                <button class="login-option-btn admin-login" data-role="admin">
                    <i class="fas fa-cog"></i>
                    <div>
                        <div style="font-weight: 700; color: var(--secondary);">Admin Login</div>
                        <div style="font-size: 0.9rem; color: #666;">Manage platform</div>
                    </div>
                </button>
            </div>
            
            <input type="tel" class="login-input" id="phone-input" placeholder="Enter your phone number" value="08031234567">
            <button class="login-btn" id="login-btn">Continue</button>
            
            <p style="margin-top: 20px; font-size: 0.9rem; color: #666;">
                Demo: Select role and click Continue
            </p>
        </div>
    </div>
    
    <!-- Main App (hidden until login) -->
    <div class="main-app hidden" id="main-app">
        <header>
            <div class="container header-content">
                <div class="logo" id="logo">
                    <i class="fas fa-car"></i>
                    <div>TOP<span>DRIVE</span></div>
                </div>
                
                <div class="app-mode" id="app-mode">
                    <button class="mode-btn active" id="user-mode">
                        <i class="fas fa-user"></i> User App
                    </button>
                    <button class="mode-btn" id="driver-mode">
                        <i class="fas fa-car"></i> Driver Dashboard
                    </button>
                    <button class="mode-btn" id="admin-mode">
                        <i class="fas fa-cog"></i> Admin Dashboard
                    </button>
                </div>
                
                <div class="user-menu">
                    <button class="user-menu-btn" id="wallet-btn">
                        <i class="fas fa-wallet"></i> <span id="wallet-balance">₦15,750</span>
                    </button>
                    <div class="user-avatar" id="user-avatar">JD</div>
                </div>
            </div>
        </header>
        
        <!-- User App Interface -->
        <div class="main-content" id="user-app">
            <div class="map-container">
                <div id="map"></div>
                
                <div class="map-controls">
                    <button class="map-control-btn" id="locate-btn" title="Find my location">
                        <i class="fas fa-location-crosshairs"></i>
                    </button>
                    <button class="map-control-btn" id="zoom-in-btn" title="Zoom in">
                        <i class="fas fa-plus"></i>
                    </button>
                    <button class="map-control-btn" id="zoom-out-btn" title="Zoom out">
                        <i class="fas fa-minus"></i>
                    </button>
                </div>
            </div>
            
            <div class="ride-panel">
                <!-- Initial booking panel -->
                <div class="booking-panel" id="booking-panel">
                    <div class="panel-title">
                        <i class="fas fa-route"></i>
                        Book Your Ride in Ijebu-Ode
                    </div>
                    
                    <div class="ijebu-locations">
                        <div class="section-title">Popular Ijebu-Ode Locations</div>
                        <div class="locations-grid" id="ijebu-locations">
                            <!-- Ijebu locations will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <div class="location-inputs">
                        <div class="input-group" id="pickup-input">
                            <i class="fas fa-circle" style="color: #1a5fb4;"></i>
                            <input type="text" id="pickup" placeholder="Enter pickup location" value="Ijebu-Ode Central Market">
                        </div>
                        
                        <div class="swap-locations">
                            <button class="swap-btn" id="swap-locations">
                                <i class="fas fa-exchange-alt"></i>
                            </button>
                        </div>
                        
                        <div class="input-group" id="destination-input">
                            <i class="fas fa-flag-checkered" style="color: #28a745;"></i>
                            <input type="text" id="destination" placeholder="Enter destination" value="Ogun State Polytechnic">
                        </div>
                    </div>
                    
                    <div class="car-selection">
                        <div class="section-title">Select Your Car Type</div>
                        <div class="cars-grid" id="cars-grid">
                            <!-- Car options will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <button class="find-driver-btn" id="find-driver-btn">
                        <i class="fas fa-search"></i> Find Available Drivers
                    </button>
                </div>
                
                <!-- Driver offers panel -->
                <div class="driver-offers-panel" id="driver-offers-panel">
                    <h3 class="offers-title">Driver Offers</h3>
                    <p class="offers-subtitle">3 drivers available near you</p>
                    
                    <div class="offers-list" id="offers-list">
                        <!-- Driver offers will be populated by JavaScript -->
                    </div>
                </div>
                
                <!-- Ride status panel -->
                <div class="ride-status-panel" id="ride-status-panel">
                    <div class="status-header">
                        <div class="status-title">Your Ride</div>
                        <div class="status-badge" id="status-badge">Driver En Route</div>
                    </div>
                    
                    <div class="driver-info" id="driver-info">
                        <!-- Driver info will be populated by JavaScript -->
                    </div>
                    
                    <div class="ride-details">
                        <div class="ride-detail">
                            <span>Pickup</span>
                            <span id="ride-pickup">Ijebu-Ode Central Market</span>
                        </div>
                        <div class="ride-detail">
                            <span>Destination</span>
                            <span id="ride-destination">Ogun State Polytechnic</span>
                        </div>
                        <div class="ride-detail">
                            <span>Car Type</span>
                            <span id="ride-car">Toyota Camry</span>
                        </div>
                        <div class="ride-detail">
                            <span>Fare</span>
                            <span id="ride-fare">₦850</span>
                        </div>
                    </div>
                    
                    <div class="ride-progress">
                        <div class="progress-bar-container">
                            <div class="progress-bar" id="progress-bar"></div>
                        </div>
                        <div class="progress-steps">
                            <div class="progress-step completed" id="step1">
                                <div class="step-indicator"></div>
                                <span>Booked</span>
                            </div>
                            <div class="progress-step active" id="step2">
                                <div class="step-indicator"></div>
                                <span>Pickup</span>
                            </div>
                            <div class="progress-step" id="step3">
                                <div class="step-indicator"></div>
                                <span>On Trip</span>
                            </div>
                            <div class="progress-step" id="step4">
                                <div class="step-indicator"></div>
                                <span>Complete</span>
                            </div>
                        </div>
                    </div>
                    
                    <button class="cancel-ride-btn" id="cancel-ride-btn">
                        <i class="fas fa-times"></i> Cancel Ride
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Driver Dashboard Interface -->
        <div class="driver-dashboard" id="driver-dashboard">
            <div class="driver-header">
                <div class="driver-title">
                    <i class="fas fa-car"></i>
                    Driver Dashboard
                </div>
                
                <div class="driver-status-toggle">
                    <div class="online-status" id="driver-status-text">Online</div>
                    <label class="status-toggle">
                        <input type="checkbox" id="driver-status-toggle" checked>
                        <span class="status-slider"></span>
                    </label>
                </div>
            </div>
            
            <div class="driver-stats">
                <div class="driver-stat-card">
                    <div class="driver-stat-icon">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                    <div class="driver-stat-info">
                        <h3>₦42,850</h3>
                        <p>Today's Earnings</p>
                    </div>
                </div>
                <div class="driver-stat-card">
                    <div class="driver-stat-icon">
                        <i class="fas fa-road"></i>
                    </div>
                    <div class="driver-stat-info">
                        <h3>18</h3>
                        <p>Trips Today</p>
                    </div>
                </div>
                <div class="driver-stat-card">
                    <div class="driver-stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="driver-stat-info">
                        <h3>6.2h</h3>
                        <p>Online Today</p>
                    </div>
                </div>
                <div class="driver-stat-card">
                    <div class="driver-stat-icon">
                        <i class="fas fa-star"></i>
                    </div>
                    <div class="driver-stat-info">
                        <h3>4.87</h3>
                        <p>Your Rating</p>
                    </div>
                </div>
            </div>
            
            <div class="driver-tabs">
                <div class="driver-tab active" data-tab="requests">Live Requests</div>
                <div class="driver-tab" data-tab="active">Active Ride</div>
                <div class="driver-tab" data-tab="earnings">Earnings</div>
                <div class="driver-tab" data-tab="rating">Rating</div>
            </div>
            
            <!-- Live Ride Requests Tab -->
            <div class="driver-tab-content active" id="requests-tab">
                <div class="ride-requests" id="ride-requests">
                    <!-- Ride requests will be populated by JavaScript -->
                </div>
            </div>
            
            <!-- Active Ride Tab -->
            <div class="driver-tab-content" id="active-tab">
                <div class="active-ride-panel" id="active-ride-panel">
                    <!-- Active ride will be populated by JavaScript -->
                </div>
            </div>
            
            <!-- Earnings Tab -->
            <div class="driver-tab-content" id="earnings-tab">
                <div class="earnings-chart">
                    <h3>Earnings Overview</h3>
                    <p style="color: #666; margin-bottom: 15px;">Last 7 days in Ijebu-Ode</p>
                    <div class="chart-placeholder">
                        <div style="text-align: center;">
                            <i class="fas fa-chart-line" style="font-size: 3rem; margin-bottom: 15px; color: var(--driver-color);"></i>
                            <p>Earnings Chart Visualization</p>
                            <p style="font-size: 0.9rem; margin-top: 10px;">Daily: ₦28,000 - ₦45,000</p>
                        </div>
                    </div>
                </div>
                
                <div class="data-table">
                    <div class="table-header">
                        <div class="table-title">Recent Earnings</div>
                        <div class="table-controls">
                            <button><i class="fas fa-download"></i> Export</button>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Trip ID</th>
                                <th>Time</th>
                                <th>Pickup</th>
                                <th>Destination</th>
                                <th>Fare</th>
                                <th>Commission</th>
                                <th>Net Earnings</th>
                            </tr>
                        </thead>
                        <tbody id="earnings-table-body">
                            <!-- Earnings data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Rating Tab -->
            <div class="driver-tab-content" id="rating-tab">
                <div class="driver-rating-card">
                    <div class="rating-stars">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star-half-alt"></i>
                    </div>
                    <div class="rating-number">4.87</div>
                    <div class="rating-count">From 1,248 trips</div>
                </div>
                
                <div class="data-table">
                    <div class="table-header">
                        <div class="table-title">Recent Reviews</div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Rider</th>
                                <th>Date</th>
                                <th>Rating</th>
                                <th>Comment</th>
                            </tr>
                        </thead>
                        <tbody id="reviews-table-body">
                            <!-- Reviews data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Admin Dashboard Interface -->
        <div class="admin-dashboard" id="admin-dashboard">
            <div class="admin-header">
                <div class="admin-title">
                    <i class="fas fa-cog"></i>
                    Admin Dashboard
                </div>
                <div class="user-avatar">AD</div>
            </div>
            
            <div class="admin-stats">
                <div class="stat-card">
                    <div class="stat-icon" style="background: #1a5fb4;">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                    <div class="stat-info">
                        <h3>₦248,560</h3>
                        <p>Total Revenue</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: #28a745;">
                        <i class="fas fa-car"></i>
                    </div>
                    <div class="stat-info">
                        <h3>1,248</h3>
                        <p>Total Rides</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: #ffcc00;">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-info">
                        <h3>42</h3>
                        <p>Active Drivers</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: #dc3545;">
                        <i class="fas fa-user-friends"></i>
                    </div>
                    <div class="stat-info">
                        <h3>2,847</h3>
                        <p>Registered Users</p>
                    </div>
                </div>
            </div>
            
            <div class="admin-tabs">
                <div class="admin-tab active" data-tab="rides">Ride Management</div>
                <div class="admin-tab" data-tab="drivers">Driver Management</div>
                <div class="admin-tab" data-tab="finance">Financial Overview</div>
            </div>
            
            <!-- Rides Management Tab -->
            <div class="tab-content active" id="rides-tab">
                <div class="data-table">
                    <div class="table-header">
                        <div class="table-title">Recent Rides in Ijebu-Ode</div>
                        <div class="table-controls">
                            <button><i class="fas fa-download"></i> Export</button>
                            <button><i class="fas fa-filter"></i> Filter</button>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Ride ID</th>
                                <th>User</th>
                                <th>Driver</th>
                                <th>Pickup</th>
                                <th>Destination</th>
                                <th>Fare</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="rides-table-body">
                            <!-- Rides data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Drivers Management Tab -->
            <div class="tab-content" id="drivers-tab">
                <div class="data-table">
                    <div class="table-header">
                        <div class="table-title">Driver Management</div>
                        <div class="table-controls">
                            <button><i class="fas fa-plus"></i> Add Driver</button>
                            <button><i class="fas fa-sync"></i> Refresh</button>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Driver ID</th>
                                <th>Name</th>
                                <th>Vehicle</th>
                                <th>Phone</th>
                                <th>Rating</th>
                                <th>Status</th>
                                <th>Earnings</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="drivers-table-body">
                            <!-- Drivers data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Financial Overview Tab -->
            <div class="tab-content" id="finance-tab">
                <div class="data-table">
                    <div class="table-header">
                        <div class="table-title">Transaction History</div>
                        <div class="table-controls">
                            <button><i class="fas fa-calendar"></i> Date Range</button>
                            <button><i class="fas fa-print"></i> Print</button>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Transaction ID</th>
                                <th>Date</th>
                                <th>Description</th>
                                <th>User/Driver</th>
                                <th>Amount</th>
                                <th>Type</th>
                            </tr>
                        </thead>
                        <tbody id="transactions-table-body">
                            <!-- Transactions data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== LOGIN FUNCTIONALITY ====================
        const loginScreen = document.getElementById('login-screen');
        const mainApp = document.getElementById('main-app');
        const loginBtn = document.getElementById('login-btn');
        const loginOptions = document.querySelectorAll('.login-option-btn');
        
        let selectedRole = 'user'; // user, driver, admin
        
        loginOptions.forEach(option => {
            option.addEventListener('click', () => {
                // Remove active class from all options
                loginOptions.forEach(opt => opt.style.borderColor = '#e1e5eb');
                
                // Add active border to selected option
                option.style.borderColor = getRoleColor(option.dataset.role);
                
                selectedRole = option.dataset.role;
            });
        });
        
        function getRoleColor(role) {
            switch(role) {
                case 'user': return '#0a2e5c';
                case 'driver': return '#28a745';
                case 'admin': return '#1a5fb4';
                default: return '#0a2e5c';
            }
        }
        
        loginBtn.addEventListener('click', () => {
            // Hide login screen with fade effect
            loginScreen.classList.add('hidden');
            
            // Show main app after a short delay
            setTimeout(() => {
                mainApp.classList.remove('hidden');
                initApp(selectedRole);
            }, 500);
        });
        
        // ==================== APP MODE SWITCHING ====================
        const userApp = document.getElementById('user-app');
        const driverDashboard = document.getElementById('driver-dashboard');
        const adminDashboard = document.getElementById('admin-dashboard');
        const userModeBtn = document.getElementById('user-mode');
        const driverModeBtn = document.getElementById('driver-mode');
        const adminModeBtn = document.getElementById('admin-mode');
        const logo = document.getElementById('logo');
        const walletBtn = document.getElementById('wallet-btn');
        const userAvatar = document.getElementById('user-avatar');
        
        function switchToUserMode() {
            userModeBtn.classList.add('active');
            driverModeBtn.classList.remove('active');
            adminModeBtn.classList.remove('active');
            userApp.style.display = 'flex';
            driverDashboard.style.display = 'none';
            adminDashboard.style.display = 'none';
            
            // Update wallet button for user
            walletBtn.innerHTML = '<i class="fas fa-wallet"></i> <span id="wallet-balance">₦15,750</span>';
            walletBtn.classList.remove('driver-menu-btn');
            userAvatar.textContent = 'JD';
            userAvatar.style.background = '#ffcc00';
        }
        
        function switchToDriverMode() {
            driverModeBtn.classList.add('active');
            userModeBtn.classList.remove('active');
            adminModeBtn.classList.remove('active');
            userApp.style.display = 'none';
            driverDashboard.style.display = 'block';
            adminDashboard.style.display = 'none';
            
            // Update wallet button for driver
            walletBtn.innerHTML = '<i class="fas fa-wallet"></i> <span id="wallet-balance">₦42,850</span>';
            walletBtn.classList.add('driver-menu-btn');
            userAvatar.textContent = 'EO';
            userAvatar.style.background = '#28a745';
            
            initDriverDashboard();
        }
        
        function switchToAdminMode() {
            adminModeBtn.classList.add('active');
            userModeBtn.classList.remove('active');
            driverModeBtn.classList.remove('active');
            userApp.style.display = 'none';
            driverDashboard.style.display = 'none';
            adminDashboard.style.display = 'block';
            
            // Update for admin
            walletBtn.innerHTML = '<i class="fas fa-chart-bar"></i> Analytics';
            walletBtn.classList.remove('driver-menu-btn');
            userAvatar.textContent = 'AD';
            userAvatar.style.background = '#1a5fb4';
            
            initAdminDashboard();
        }
        
        userModeBtn.addEventListener('click', switchToUserMode);
        driverModeBtn.addEventListener('click', switchToDriverMode);
        adminModeBtn.addEventListener('click', switchToAdminMode);
        
        logo.addEventListener('click', () => {
            if (selectedRole === 'user') switchToUserMode();
            else if (selectedRole === 'driver') switchToDriverMode();
            else switchToAdminMode();
        });
        
        // ==================== INITIALIZE BASED ON ROLE ====================
        function initApp(role) {
            initMap();
            initIjebuLocations();
            initCarSelection();
            
            if (role === 'user') {
                switchToUserMode();
                setupUserApp();
            } else if (role === 'driver') {
                switchToDriverMode();
            } else {
                switchToAdminMode();
            }
        }
        
        // ==================== IJEBU-ODE LOCATIONS ====================
        const ijebuLocations = [
            {name: "Ijebu-Ode Central Market", lat: 6.8220, lng: 3.9230, type: "market"},
            {name: "Ogun State Polytechnic", lat: 6.8150, lng: 3.9150, type: "school"},
            {name: "Awujale Palace", lat: 6.8180, lng: 3.9280, type: "landmark"},
            {name: "Itoro Park", lat: 6.8250, lng: 3.9180, type: "park"},
            {name: "Ijebu-Ode General Hospital", lat: 6.8270, lng: 3.9350, type: "hospital"},
            {name: "Ijebu-Ode Stadium", lat: 6.8120, lng: 3.9100, type: "stadium"},
            {name: "Odogbolu Junction", lat: 6.8350, lng: 3.9050, type: "junction"},
            {name: "Ijebu-Ode Motor Park", lat: 6.8300, lng: 3.9250, type: "transport"}
        ];
        
        function initIjebuLocations() {
            const locationsGrid = document.getElementById('ijebu-locations');
            
            ijebuLocations.forEach(location => {
                const locationElement = document.createElement('div');
                locationElement.className = 'location-tag';
                locationElement.innerHTML = `
                    <i class="fas fa-map-marker-alt" style="color: #1a5fb4; margin-right: 5px;"></i>
                    ${location.name}
                `;
                
                locationElement.addEventListener('click', () => {
                    document.getElementById('pickup').value = location.name;
                    if (pickupMarker) {
                        pickupMarker.setLatLng([location.lat, location.lng]);
                        updateRoute();
                    }
                });
                
                locationsGrid.appendChild(locationElement);
            });
        }
        
        // ==================== MAP INITIALIZATION ====================
        let map, pickupMarker, destinationMarker, routePolyline, carMarkers = [], movingCarMarker;
        
        function initMap() {
            // Ijebu-Ode coordinates
            map = L.map('map').setView([6.8206, 3.9206], 14);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);
            
            // Add pickup and destination markers
            pickupMarker = L.marker([ijebuLocations[0].lat, ijebuLocations[0].lng], {
                icon: L.divIcon({
                    className: 'custom-marker',
                    html: '<div style="background:#1a5fb4; width:24px; height:24px; border-radius:50%; border:3px solid white; box-shadow:0 0 8px rgba(0,0,0,0.3);"></div>',
                    iconSize: [24, 24]
                })
            }).addTo(map).bindPopup('<b>Pickup Location</b><br>Ijebu-Ode Central Market');
            
            destinationMarker = L.marker([ijebuLocations[1].lat, ijebuLocations[1].lng], {
                icon: L.divIcon({
                    className: 'custom-marker',
                    html: '<div style="background:#28a745; width:24px; height:24px; border-radius:50%; border:3px solid white; box-shadow:0 0 8px rgba(0,0,0,0.3);"></div>',
                    iconSize: [24, 24]
                })
            }).addTo(map).bindPopup('<b>Destination</b><br>Ogun State Polytechnic');
            
            // Add Ijebu-Ode location markers
            ijebuLocations.forEach(location => {
                let iconColor = '#1a5fb4';
                if (location.type === 'school') iconColor = '#28a745';
                if (location.type === 'hospital') iconColor = '#dc3545';
                if (location.type === 'park') iconColor = '#20c997';
                
                L.marker([location.lat, location.lng], {
                    icon: L.divIcon({
                        className: 'location-marker',
                        html: `<div style="background:${iconColor}; width:16px; height:16px; border-radius:50%; border:2px solid white; box-shadow:0 0 6px rgba(0,0,0,0.3);"></div>`,
                        iconSize: [16, 16]
                    })
                }).addTo(map).bindPopup(`<b>${location.name}</b><br>${location.type}`);
            });
            
            // Create route coordinates (Central Market to Ogun Poly)
            const routeCoordinates = [
                [ijebuLocations[0].lat, ijebuLocations[0].lng], // Central Market
                [6.8210, 3.9220],
                [6.8190, 3.9200],
                [6.8170, 3.9180],
                [6.8160, 3.9160],
                [ijebuLocations[1].lat, ijebuLocations[1].lng]  // Ogun Poly
            ];
            
            routePolyline = L.polyline(routeCoordinates, {
                color: '#1a5fb4',
                weight: 4,
                opacity: 0.7,
                dashArray: '10, 10'
            }).addTo(map);
            
            // Initially hide the route
            routePolyline.setStyle({ opacity: 0 });
            
            // Add fake car markers (available drivers in Ijebu-Ode)
            spawnNearbyCars();
            
            // Map controls
            document.getElementById('locate-btn').addEventListener('click', () => {
                map.setView([6.8206, 3.9206], 14);
            });
            
            document.getElementById('zoom-in-btn').addEventListener('click', () => {
                map.zoomIn();
            });
            
            document.getElementById('zoom-out-btn').addEventListener('click', () => {
                map.zoomOut();
            });
        }
        
        // Spawn fake cars around Ijebu-Ode
        function spawnNearbyCars() {
            // Clear existing car markers
            carMarkers.forEach(marker => map.removeLayer(marker));
            carMarkers = [];
            
            // Spawn 8 cars around Ijebu-Ode
            const carLocations = [
                {lat: 6.8250, lng: 3.9150},
                {lat: 6.8180, lng: 3.9200},
                {lat: 6.8220, lng: 3.9250},
                {lat: 6.8150, lng: 3.9180},
                {lat: 6.8280, lng: 3.9220},
                {lat: 6.8170, lng: 3.9150},
                {lat: 6.8230, lng: 3.9180},
                {lat: 6.8200, lng: 3.9100}
            ];
            
            carLocations.forEach((location, index) => {
                const carMarker = L.marker([location.lat, location.lng], {
                    icon: L.divIcon({
                        className: 'car-marker',
                        html: `<div style="background:#ffcc00; width:20px; height:20px; border-radius:50%; border:3px solid white; box-shadow:0 0 6px rgba(0,0,0,0.3); display:flex; align-items:center; justify-content:center;">
                                  <i class="fas fa-car" style="color:#0a2e5c; font-size:10px;"></i>
                               </div>`,
                        iconSize: [20, 20]
                    })
                }).addTo(map).bindPopup(`Available Driver ${index + 1} in Ijebu-Ode`);
                
                carMarkers.push(carMarker);
            });
        }
        
        // Update route on map
        function updateRoute() {
            const pickupValue = document.getElementById('pickup').value;
            const destValue = document.getElementById('destination').value;
            
            let pickupLoc = ijebuLocations.find(loc => loc.name === pickupValue);
            let destLoc = ijebuLocations.find(loc => loc.name === destValue);
            
            if (pickupLoc) {
                pickupMarker.setLatLng([pickupLoc.lat, pickupLoc.lng]);
            }
            
            if (destLoc) {
                destinationMarker.setLatLng([destLoc.lat, destLoc.lng]);
            }
            
            // Update route coordinates
            if (pickupLoc && destLoc) {
                const newRoute = [
                    [pickupLoc.lat, pickupLoc.lng],
                    [pickupLoc.lat + 0.001, pickupLoc.lng - 0.001],
                    [destLoc.lat - 0.001, destLoc.lng + 0.001],
                    [destLoc.lat, destLoc.lng]
                ];
                routePolyline.setLatLngs(newRoute);
            }
        }
        
        // ==================== CAR SELECTION ====================
        const carOptions = [
            {id: 1, name: "Toyota Camry", icon: "fas fa-car", price: "₦850", capacity: "4 passengers", color: "#0a2e5c"},
            {id: 2, name: "Honda Accord", icon: "fas fa-car-side", price: "₦950", capacity: "4 passengers", color: "#1a5fb4"},
            {id: 3, name: "Toyota Corolla", icon: "fas fa-car", price: "₦750", capacity: "4 passengers", color: "#28a745"},
            {id: 4, name: "SUV (Toyota RAV4)", icon: "fas fa-shuttle-van", price: "₦1,200", capacity: "6 passengers", color: "#dc3545"}
        ];
        
        let selectedCarId = 1;
        
        function initCarSelection() {
            const carsGrid = document.getElementById('cars-grid');
            
            carOptions.forEach(car => {
                const carElement = document.createElement('div');
                carElement.className = `car-option ${car.id === selectedCarId ? 'selected' : ''}`;
                carElement.setAttribute('data-id', car.id);
                carElement.innerHTML = `
                    <div class="car-icon"><i class="${car.icon}"></i></div>
                    <div class="car-name">${car.name}</div>
                    <div class="car-price">${car.price}</div>
                    <div class="car-capacity">${car.capacity}</div>
                `;
                
                carElement.addEventListener('click', () => {
                    document.querySelectorAll('.car-option').forEach(el => el.classList.remove('selected'));
                    carElement.classList.add('selected');
                    selectedCarId = car.id;
                });
                
                carsGrid.appendChild(carElement);
            });
        }
        
        // ==================== USER APP FUNCTIONALITY ====================
        function setupUserApp() {
            // Setup event listeners
            document.getElementById('find-driver-btn').addEventListener('click', showDriverOffers);
            
            document.getElementById('swap-locations').addEventListener('click', () => {
                const pickupInput = document.getElementById('pickup');
                const destinationInput = document.getElementById('destination');
                
                const tempValue = pickupInput.value;
                pickupInput.value = destinationInput.value;
                destinationInput.value = tempValue;
                updateRoute();
            });
            
            document.getElementById('cancel-ride-btn').addEventListener('click', () => {
                if (confirm("Are you sure you want to cancel this ride?")) {
                    clearInterval(rideInterval);
                    
                    // Reset to booking panel
                    document.getElementById('ride-status-panel').classList.remove('visible');
                    document.getElementById('driver-offers-panel').classList.remove('visible');
                    document.getElementById('booking-panel').classList.remove('hidden');
                    
                    // Reset map
                    if (movingCarMarker) {
                        map.removeLayer(movingCarMarker);
                    }
                    routePolyline.setStyle({ opacity: 0 });
                    spawnNearbyCars();
                    map.setView([6.8206, 3.9206], 14);
                    
                    alert("Ride cancelled successfully.");
                }
            });
            
            document.getElementById('wallet-btn').addEventListener('click', () => {
                alert(`Your wallet balance: ${document.getElementById('wallet-balance').textContent}\n\nYou can add funds via:\n- Bank Transfer\n- Debit Card\n- USSD (*123*1#)`);
            });
            
            // Add pulse animation to find driver button
            setTimeout(() => {
                document.getElementById('find-driver-btn').classList.add('pulse');
            }, 1000);
        }
        
        // ==================== DRIVER OFFERS ====================
        const driverOffers = [
            {id: 1, name: "Emmanuel O.", rating: 4.9, car: "Toyota Camry 2020", price: "₦850", eta: "3 min", color: "#0a2e5c"},
            {id: 2, name: "Chinwe O.", rating: 4.7, car: "Honda Accord 2021", price: "₦900", eta: "5 min", color: "#1a5fb4"},
            {id: 3, name: "Musa I.", rating: 4.8, car: "Toyota Camry 2019", price: "₦800", eta: "7 min", color: "#28a745"}
        ];
        
        function showDriverOffers() {
            // Switch to driver offers panel
            document.getElementById('booking-panel').classList.add('hidden');
            document.getElementById('driver-offers-panel').classList.add('visible');
            document.getElementById('ride-status-panel').classList.remove('visible');
            
            // Populate offers list
            const offersList = document.getElementById('offers-list');
            offersList.innerHTML = '';
            
            driverOffers.forEach(offer => {
                const offerElement = document.createElement('div');
                offerElement.className = 'driver-offer';
                offerElement.setAttribute('data-id', offer.id);
                offerElement.innerHTML = `
                    <div class="offer-header">
                        <div class="driver-name">${offer.name}</div>
                        <div class="offer-price">${offer.price}</div>
                    </div>
                    <div class="offer-details">
                        <div class="driver-rating">
                            <i class="fas fa-star"></i> ${offer.rating}
                        </div>
                        <div class="driver-car">${offer.car}</div>
                    </div>
                    <div class="driver-eta">
                        <i class="fas fa-clock"></i> ${offer.eta} away
                    </div>
                    <div class="offer-actions">
                        <button class="accept-btn" data-id="${offer.id}">
                            <i class="fas fa-check"></i> Accept
                        </button>
                        <button class="counter-btn" data-id="${offer.id}">
                            <i class="fas fa-exchange-alt"></i> Counter Offer
                        </button>
                    </div>
                `;
                
                offersList.appendChild(offerElement);
            });
            
            // Add event listeners to accept buttons
            document.querySelectorAll('.accept-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const driverId = parseInt(btn.getAttribute('data-id'));
                    acceptDriverOffer(driverId);
                });
            });
            
            // Add event listeners to counter buttons
            document.querySelectorAll('.counter-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const driverId = parseInt(btn.getAttribute('data-id'));
                    showCounterOffer(driverId);
                });
            });
            
            // Add selection effect to offers
            document.querySelectorAll('.driver-offer').forEach(offer => {
                offer.addEventListener('click', () => {
                    document.querySelectorAll('.driver-offer').forEach(el => el.classList.remove('selected'));
                    offer.classList.add('selected');
                });
            });
        }
        
        function acceptDriverOffer(driverId) {
            const selectedOffer = driverOffers.find(offer => offer.id === driverId);
            const selectedCar = carOptions.find(car => car.id === selectedCarId);
            
            // Switch to ride status panel
            document.getElementById('driver-offers-panel').classList.remove('visible');
            document.getElementById('ride-status-panel').classList.add('visible');
            
            // Update driver info
            document.getElementById('driver-info').innerHTML = `
                <div class="driver-avatar-large">
                    ${selectedOffer.name.split(' ').map(n => n[0]).join('')}
                </div>
                <div class="driver-details">
                    <h4>${selectedOffer.name}</h4>
                    <div class="rating">
                        <i class="fas fa-star"></i> ${selectedOffer.rating}
                    </div>
                    <div class="car">${selectedOffer.car}</div>
                </div>
            `;
            
            // Update ride details
            document.getElementById('ride-pickup').textContent = document.getElementById('pickup').value;
            document.getElementById('ride-destination').textContent = document.getElementById('destination').value;
            document.getElementById('ride-car').textContent = selectedCar.name;
            document.getElementById('ride-fare').textContent = selectedOffer.price;
            
            // Start the ride simulation
            startRideSimulation(driverId);
        }
        
        function showCounterOffer(driverId) {
            const selectedOffer = driverOffers.find(offer => offer.id === driverId);
            const newPrice = Math.floor(parseInt(selectedOffer.price.replace('₦', '').replace(',', '')) * 0.9);
            
            alert(`Counter offer sent to ${selectedOffer.name}!\n\nYour offer: ₦${newPrice.toLocaleString()}\n\nWaiting for driver response...`);
            
            // Simulate driver accepting counter offer after 2 seconds
            setTimeout(() => {
                alert(`${selectedOffer.name} has accepted your counter offer of ₦${newPrice.toLocaleString()}!`);
                acceptDriverOffer(driverId);
            }, 2000);
        }
        
        // ==================== RIDE SIMULATION ====================
        let rideInterval;
        let rideProgress = 0;
        
        function startRideSimulation(driverId) {
            // Update status badge
            document.getElementById('status-badge').textContent = 'Driver En Route';
            
            // Show route on map
            routePolyline.setStyle({ opacity: 0.7 });
            
            // Remove other car markers
            carMarkers.forEach(marker => map.removeLayer(marker));
            
            // Create moving car marker
            movingCarMarker = L.marker([6.8250, 3.9150], {
                icon: L.divIcon({
                    className: 'moving-car-marker',
                    html: `<div style="background:#1a5fb4; width:30px; height:30px; border-radius:50%; border:3px solid white; box-shadow:0 0 10px rgba(26, 95, 180, 0.5); display:flex; align-items:center; justify-content:center;">
                              <i class="fas fa-car" style="color:white; font-size:14px;"></i>
                           </div>`,
                    iconSize: [30, 30]
                })
            }).addTo(map);
            
            // Zoom to show route
            map.fitBounds(routePolyline.getBounds(), { padding: [50, 50] });
            
            // Start progress simulation
            rideProgress = 0;
            rideInterval = setInterval(() => {
                rideProgress += 5;
                
                // Update progress bar
                document.getElementById('progress-bar').style.width = `${rideProgress}%`;
                
                // Update progress steps
                if (rideProgress >= 25) {
                    document.getElementById('step2').classList.add('completed');
                    document.getElementById('step2').classList.remove('active');
                    document.getElementById('step3').classList.add('active');
                    document.getElementById('status-badge').textContent = 'On Trip';
                }
                
                if (rideProgress >= 75) {
                    document.getElementById('step3').classList.add('completed');
                    document.getElementById('step3').classList.remove('active');
                    document.getElementById('step4').classList.add('active');
                    document.getElementById('status-badge').textContent = 'Arriving Soon';
                }
                
                // Move car along route
                if (rideProgress <= 100) {
                    const route = routePolyline.getLatLngs();
                    const segmentIndex = Math.floor((rideProgress / 100) * (route.length - 1));
                    const segmentProgress = (rideProgress / 100) * (route.length - 1) - segmentIndex;
                    
                    if (segmentIndex < route.length - 1) {
                        const startPoint = route[segmentIndex];
                        const endPoint = route[segmentIndex + 1];
                        
                        const lat = startPoint.lat + (endPoint.lat - startPoint.lat) * segmentProgress;
                        const lng = startPoint.lng + (endPoint.lng - startPoint.lng) * segmentProgress;
                        
                        movingCarMarker.setLatLng([lat, lng]);
                    }
                }
                
                // Complete ride at 100%
                if (rideProgress >= 100) {
                    clearInterval(rideInterval);
                    document.getElementById('step4').classList.add('completed');
                    document.getElementById('status-badge').textContent = 'Completed';
                    
                    // Update wallet balance
                    const currentBalance = parseInt(document.getElementById('wallet-balance').textContent.replace('₦', '').replace(',', ''));
                    const rideFare = parseInt(driverOffers.find(o => o.id === driverId).price.replace('₦', '').replace(',', ''));
                    const newBalance = currentBalance - rideFare;
                    document.getElementById('wallet-balance').textContent = `₦${newBalance.toLocaleString()}`;
                    
                    // Show completion message
                    setTimeout(() => {
                        alert(`You have arrived at ${document.getElementById('destination').value}!\n\n₦${rideFare.toLocaleString()} has been deducted from your wallet.\n\nThank you for choosing Top Drive Ijebu-Ode!`);
                    }, 1000);
                }
            }, 300);
        }
        
        // ==================== DRIVER DASHBOARD ====================
        function initDriverDashboard() {
            // Driver status toggle
            const driverStatusToggle = document.getElementById('driver-status-toggle');
            const driverStatusText = document.getElementById('driver-status-text');
            
            driverStatusToggle.addEventListener('change', function() {
                if (this.checked) {
                    driverStatusText.textContent = 'Online';
                    driverStatusText.style.background = '#28a745';
                    simulateLiveRequests();
                } else {
                    driverStatusText.textContent = 'Offline';
                    driverStatusText.style.background = '#6c757d';
                    clearInterval(requestInterval);
                }
            });
            
            // Driver tab switching
            const driverTabs = document.querySelectorAll('.driver-tab');
            const driverTabContents = document.querySelectorAll('.driver-tab-content');
            
            driverTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    
                    // Update active tab
                    driverTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    // Show corresponding content
                    driverTabContents.forEach(content => content.classList.remove('active'));
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
            
            // Initialize data
            initDriverData();
            
            // Start simulating live requests if driver is online
            if (driverStatusToggle.checked) {
                simulateLiveRequests();
            }
        }
        
        let requestInterval;
        
        function simulateLiveRequests() {
            clearInterval(requestInterval);
            
            // Initial requests
            updateRideRequests();
            
            // Simulate new requests every 8 seconds
            requestInterval = setInterval(updateRideRequests, 8000);
        }
        
        const rideRequestsData = [
            {
                id: 1,
                price: "₦850",
                timer: "45s",
                pickup: "Ijebu-Ode Central Market",
                destination: "Ogun State Polytechnic",
                distance: "2.1 km",
                carType: "Toyota Camry"
            },
            {
                id: 2,
                price: "₦1,200",
                timer: "32s",
                pickup: "Awujale Palace",
                destination: "Itoro Park",
                distance: "3.5 km",
                carType: "SUV"
            },
            {
                id: 3,
                price: "₦650",
                timer: "18s",
                pickup: "General Hospital",
                destination: "Motor Park",
                distance: "1.8 km",
                carType: "Toyota Corolla"
            }
        ];
        
        function updateRideRequests() {
            const rideRequestsContainer = document.getElementById('ride-requests');
            rideRequestsContainer.innerHTML = '';
            
            rideRequestsData.forEach(request => {
                const requestElement = document.createElement('div');
                requestElement.className = 'ride-request-card';
                requestElement.innerHTML = `
                    <div class="request-header">
                        <div class="request-price">${request.price}</div>
                        <div class="request-timer blink">${request.timer}</div>
                    </div>
                    <div class="request-details">
                        <div class="request-location">
                            <i class="fas fa-circle" style="color: #1a5fb4;"></i>
                            <span>${request.pickup}</span>
                        </div>
                        <div class="request-location">
                            <i class="fas fa-flag-checkered" style="color: #28a745;"></i>
                            <span>${request.destination}</span>
                        </div>
                        <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                            <i class="fas fa-road"></i> ${request.distance} • <i class="fas fa-car"></i> ${request.carType}
                        </div>
                    </div>
                    <div class="request-actions">
                        <button class="accept-request-btn" data-id="${request.id}">
                            <i class="fas fa-check"></i> Accept Request
                        </button>
                        <button class="decline-request-btn" data-id="${request.id}">
                            <i class="fas fa-times"></i> Decline
                        </button>
                    </div>
                `;
                
                rideRequestsContainer.appendChild(requestElement);
            });
            
            // Add event listeners to accept buttons
            document.querySelectorAll('.accept-request-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const requestId = parseInt(btn.getAttribute('data-id'));
                    acceptRideRequest(requestId);
                });
            });
            
            // Add event listeners to decline buttons
            document.querySelectorAll('.decline-request-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const requestId = parseInt(btn.getAttribute('data-id'));
                    declineRideRequest(requestId);
                });
            });
        }
        
        function acceptRideRequest(requestId) {
            const request = rideRequestsData.find(r => r.id === requestId);
            alert(`You accepted the ride request!\n\nFrom: ${request.pickup}\nTo: ${request.destination}\nFare: ${request.price}\n\nNavigate to pickup location.`);
            
            // Switch to active ride tab
            document.querySelector('.driver-tab[data-tab="active"]').click();
            
            // Update active ride panel
            document.getElementById('active-ride-panel').innerHTML = `
                <div class="active-ride-header">
                    <div class="active-ride-title">Active Ride</div>
                    <div class="active-ride-status">En Route to Pickup</div>
                </div>
                <div class="active-ride-details">
                    <div class="rider-info">
                        <div class="rider-avatar">JD</div>
                        <div class="rider-details">
                            <h4>John D.</h4>
                            <div class="rating">
                                <i class="fas fa-star"></i> 4.8
                            </div>
                            <div class="phone">0803 123 4567</div>
                        </div>
                    </div>
                    <div class="request-location">
                        <i class="fas fa-circle" style="color: #1a5fb4;"></i>
                        <span><strong>Pickup:</strong> ${request.pickup}</span>
                    </div>
                    <div class="request-location">
                        <i class="fas fa-flag-checkered" style="color: #28a745;"></i>
                        <span><strong>Destination:</strong> ${request.destination}</span>
                    </div>
                    <div style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                        <div style="display: flex; justify-content: space-between;">
                            <span>Fare:</span>
                            <span style="font-weight: 700; font-size: 1.2rem;">${request.price}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                            <span>Distance:</span>
                            <span>${request.distance}</span>
                        </div>
                    </div>
                </div>
                <div class="ride-actions">
                    <button class="ride-action-btn arrived-btn" id="arrived-btn">
                        <i class="fas fa-check-circle"></i> Arrived at Pickup
                    </button>
                    <button class="ride-action-btn start-trip-btn" id="start-trip-btn" style="display: none;">
                        <i class="fas fa-play-circle"></i> Start Trip
                    </button>
                    <button class="ride-action-btn complete-trip-btn" id="complete-trip-btn" style="display: none;">
                        <i class="fas fa-flag-checkered"></i> Complete Trip
                    </button>
                </div>
            `;
            
            // Add event listeners to ride action buttons
            document.getElementById('arrived-btn').addEventListener('click', () => {
                document.getElementById('arrived-btn').style.display = 'none';
                document.getElementById('start-trip-btn').style.display = 'block';
                document.querySelector('.active-ride-status').textContent = 'Ready for Trip';
                alert("You've arrived at the pickup location. Please start the trip when the rider is ready.");
            });
            
            document.getElementById('start-trip-btn').addEventListener('click', () => {
                document.getElementById('start-trip-btn').style.display = 'none';
                document.getElementById('complete-trip-btn').style.display = 'block';
                document.querySelector('.active-ride-status').textContent = 'On Trip';
                alert("Trip started! Please drive safely to the destination.");
            });
            
            document.getElementById('complete-trip-btn').addEventListener('click', () => {
                alert(`Trip completed successfully!\n\nFare: ${request.price}\nEarnings: ₦${Math.floor(parseInt(request.price.replace('₦', '').replace(',', '')) * 0.8).toLocaleString()}\n\nThank you for driving with Top Drive!`);
                document.getElementById('active-ride-panel').innerHTML = `
                    <div style="text-align: center; padding: 40px;">
                        <i class="fas fa-car" style="font-size: 3rem; color: #28a745; margin-bottom: 20px;"></i>
                        <h3 style="color: #28a745; margin-bottom: 15px;">No Active Ride</h3>
                        <p style="color: #666;">You're currently online and ready for new ride requests.</p>
                        <button class="accept-request-btn" style="margin-top: 20px; max-width: 300px; margin-left: auto; margin-right: auto;" onclick="document.querySelector('.driver-tab[data-tab=\"requests\"]').click()">
                            <i class="fas fa-bell"></i> View Live Requests
                        </button>
                    </div>
                `;
            });
        }
        
        function declineRideRequest(requestId) {
            const request = rideRequestsData.find(r => r.id === requestId);
            alert(`You declined the ride request from ${request.pickup} to ${request.destination}`);
        }
        
        function initDriverData() {
            // Populate earnings table
            const earningsData = [
                {id: "TRIP-001", time: "09:15 AM", pickup: "Central Market", destination: "Ogun Poly", fare: "₦850", commission: "₦170", earnings: "₦680"},
                {id: "TRIP-002", time: "10:30 AM", pickup: "Awujale Palace", destination: "Itoro Park", fare: "₦1,200", commission: "₦240", earnings: "₦960"},
                {id: "TRIP-003", time: "11:45 AM", pickup: "General Hospital", destination: "Motor Park", fare: "₦650", commission: "₦130", earnings: "₦520"},
                {id: "TRIP-004", time: "01:20 PM", pickup: "Stadium", destination: "Odogbolu", fare: "₦950", commission: "₦190", earnings: "₦760"},
                {id: "TRIP-005", time: "02:50 PM", pickup: "Motor Park", destination: "Central Market", fare: "₦750", commission: "₦150", earnings: "₦600"}
            ];
            
            const earningsTableBody = document.getElementById('earnings-table-body');
            earningsData.forEach(earning => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${earning.id}</td>
                    <td>${earning.time}</td>
                    <td>${earning.pickup}</td>
                    <td>${earning.destination}</td>
                    <td>${earning.fare}</td>
                    <td>${earning.commission}</td>
                    <td style="font-weight: 700; color: #28a745;">${earning.earnings}</td>
                `;
                earningsTableBody.appendChild(row);
            });
            
            // Populate reviews table
            const reviewsData = [
                {rider: "John D.", date: "2023-10-15", rating: 5, comment: "Great driver, very professional!"},
                {rider: "Sarah J.", date: "2023-10-14", rating: 5, comment: "Safe driver, clean car"},
                {rider: "David B.", date: "2023-10-13", rating: 4, comment: "Good service, arrived quickly"},
                {rider: "Lisa W.", date: "2023-10-12", rating: 5, comment: "Excellent driver, highly recommend"},
                {rider: "Michael C.", date: "2023-10-11", rating: 5, comment: "Very polite and helpful"}
            ];
            
            const reviewsTableBody = document.getElementById('reviews-table-body');
            reviewsData.forEach(review => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${review.rider}</td>
                    <td>${review.date}</td>
                    <td>
                        <div style="color: #ffcc00;">
                            ${'★'.repeat(review.rating)}${review.rating < 5 ? '☆'.repeat(5-review.rating) : ''}
                        </div>
                    </td>
                    <td>${review.comment}</td>
                `;
                reviewsTableBody.appendChild(row);
            });
        }
        
        // ==================== ADMIN DASHBOARD ====================
        function initAdminDashboard() {
            // Tab switching
            const adminTabs = document.querySelectorAll('.admin-tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            adminTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    
                    // Update active tab
                    adminTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    // Show corresponding content
                    tabContents.forEach(content => content.classList.remove('active'));
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
            
            // Ijebu-Ode specific sample data
            const ridesData = [
                {id: "RIDE-001", user: "John D.", driver: "Emmanuel O.", pickup: "Ijebu-Ode Central Market", destination: "Ogun State Polytechnic", fare: "₦850", status: "completed"},
                {id: "RIDE-002", user: "Sarah J.", driver: "Chinwe O.", pickup: "Awujale Palace", destination: "Itoro Park", fare: "₦650", status: "completed"},
                {id: "RIDE-003", user: "David B.", driver: "Musa I.", pickup: "General Hospital", destination: "Motor Park", fare: "₦550", status: "active"},
                {id: "RIDE-004", user: "Lisa W.", driver: "Emmanuel O.", pickup: "Odogbolu Junction", destination: "Central Market", fare: "₦750", status: "pending"},
                {id: "RIDE-005", user: "Michael C.", driver: "Chinwe O.", pickup: "Stadium", destination: "Awujale Palace", fare: "₦600", status: "cancelled"}
            ];
            
            const driversData = [
                {id: "DRIVER-001", name: "Emmanuel O.", vehicle: "Toyota Camry 2020", phone: "08031234567", rating: 4.9, status: "online", earnings: "₦125,400"},
                {id: "DRIVER-002", name: "Chinwe O.", vehicle: "Honda Accord 2021", phone: "08032345678", rating: 4.7, status: "online", earnings: "₦98,750"},
                {id: "DRIVER-003", name: "Musa I.", vehicle: "Toyota Camry 2019", phone: "08033456789", rating: 4.8, status: "offline", earnings: "₦142,300"},
                {id: "DRIVER-004", name: "Adebayo J.", vehicle: "Toyota Corolla 2020", phone: "08034567890", rating: 4.6, status: "online", earnings: "₦87,600"},
                {id: "DRIVER-005", name: "Folake A.", vehicle: "SUV (RAV4) 2021", phone: "08035678901", rating: 4.9, status: "online", earnings: "₦113,850"}
            ];
            
            const transactionsData = [
                {id: "TXN-001", date: "2023-10-15", description: "Ride fare - RIDE-001", user: "John D.", amount: "₦850", type: "Debit"},
                {id: "TXN-002", date: "2023-10-15", description: "Driver earnings", user: "Emmanuel O.", amount: "₦680", type: "Credit"},
                {id: "TXN-003", date: "2023-10-15", description: "Commission", user: "Top Drive", amount: "₦170", type: "Credit"},
                {id: "TXN-004", date: "2023-10-14", description: "Wallet top-up", user: "Sarah J.", amount: "₦5,000", type: "Credit"},
                {id: "TXN-005", date: "2023-10-14", description: "Ride fare - RIDE-002", user: "Sarah J.", amount: "₦650", type: "Debit"}
            ];
            
            // Populate rides table
            const ridesTableBody = document.getElementById('rides-table-body');
            ridesData.forEach(ride => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${ride.id}</td>
                    <td>${ride.user}</td>
                    <td>${ride.driver}</td>
                    <td>${ride.pickup}</td>
                    <td>${ride.destination}</td>
                    <td>${ride.fare}</td>
                    <td><span class="status-indicator ${ride.status === 'completed' ? 'status-completed' : ride.status === 'active' ? 'status-active' : ride.status === 'pending' ? 'status-pending' : 'status-cancelled'}">${ride.status}</span></td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn edit-btn"><i class="fas fa-edit"></i></button>
                            <button class="action-btn delete-btn"><i class="fas fa-trash"></i></button>
                        </div>
                    </td>
                `;
                ridesTableBody.appendChild(row);
            });
            
            // Populate drivers table
            const driversTableBody = document.getElementById('drivers-table-body');
            driversData.forEach(driver => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${driver.id}</td>
                    <td>${driver.name}</td>
                    <td>${driver.vehicle}</td>
                    <td>${driver.phone}</td>
                    <td>${driver.rating} <i class="fas fa-star" style="color: #ffcc00;"></i></td>
                    <td>
                        <span class="status-indicator ${driver.status === 'online' ? 'status-active' : 'status-cancelled'}">${driver.status}</span>
                    </td>
                    <td>${driver.earnings}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn edit-btn"><i class="fas fa-edit"></i></button>
                            <button class="action-btn delete-btn"><i class="fas fa-trash"></i></button>
                        </div>
                    </td>
                `;
                driversTableBody.appendChild(row);
            });
            
            // Populate transactions table
            const transactionsTableBody = document.getElementById('transactions-table-body');
            transactionsData.forEach(transaction => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${transaction.id}</td>
                    <td>${transaction.date}</td>
                    <td>${transaction.description}</td>
                    <td>${transaction.user}</td>
                    <td>${transaction.amount}</td>
                    <td><span class="status-indicator ${transaction.type === 'Credit' ? 'status-completed' : 'status-pending'}">${transaction.type}</span></td>
                `;
                transactionsTableBody.appendChild(row);
            });
        }
        
        // Demo instructions
        console.log("=== TOP DRIVE IJEBU-ODE COMPLETE PLATFORM ===");
        console.log("1. Open file and select role: User, Driver, or Admin");
        console.log("2. Click Continue to enter the platform");
        console.log("");
        console.log("USER APP DEMO:");
        console.log("- See Ijebu-Ode map with local landmarks");
        console.log("- Click locations to set as pickup");
        console.log("- Click 'Find Available Drivers'");
        console.log("- See 3 driver offers with different prices");
        console.log("- Click 'Accept' on Emmanuel O.");
        console.log("- Watch car move from Central Market to Ogun Poly");
        console.log("");
        console.log("DRIVER DASHBOARD DEMO:");
        console.log("- Toggle Online/Offline status");
        console.log("- See live ride requests with timers");
        console.log("- Click 'Accept Request' on any ride");
        console.log("- Switch to Active Ride tab");
        console.log("- Click through ride steps: Arrived → Start → Complete");
        console.log("- Check Earnings and Rating tabs");
        console.log("");
        console.log("ADMIN DASHBOARD DEMO:");
        console.log("- See platform analytics");
        console.log("- Manage rides, drivers, finances");
        console.log("- View all transactions");
    </script>
</body>
</html>